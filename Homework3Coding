
import pandas as pd
import matplotlib.pyplot as plt
from tkinter import Tk, filedialog

# Select CSV file
Tk().withdraw()
filename = filedialog.askopenfilename()

# Read data
data = pd.read_csv(filename)

# Info
print(data.info())

# Unique values per column
print(data.nunique())

# Default JupyterLab rows
print(data.head())
print(data.tail())

# Subset of rows and columns
print(data.iloc[:5, :4])
print(data.iloc[-5:, -4:])

# Select columns
selected_columns = data[['Date', 'AveragePrice', 'Total Volume']].head()
print(selected_columns)

# Dot notation access
print(data.AveragePrice.head())

# New column calculation
data['EstimatedRevenue'] = data['Total Volume'] * data['AveragePrice']
print(data[['Total Volume', 'AveragePrice', 'EstimatedRevenue']].head())

# Grouped average price
grouped_avg_price = data.groupby(['region', 'type'])['AveragePrice'].mean().reset_index()
print(grouped_avg_price.head())

# Total Volume stats plot by year
data['year'] = pd.to_datetime(data['Date']).dt.year
volume_stats_by_year = data.groupby('year')['Total Volume'].agg(['mean', 'median', 'std'])
volume_stats_by_year.plot(kind='bar', yerr='std')
plt.ylabel('Total Volume')
plt.show()

# Total bags by type DataFrame
bags_total_by_type = data.groupby('type')[['Small Bags', 'Large Bags', 'XLarge Bags']].sum()
print(bags_total_by_type)

# Bags by type plot
bags_total_by_type.plot(kind='bar')
plt.ylabel('Number of Bags')
plt.show()

# Scatter plot for Total Volume vs. AveragePrice
plt.scatter(data['Total Volume'], data['AveragePrice'])
plt.xlabel('Total Volume')
plt.ylabel('Average Price')
plt.show()
